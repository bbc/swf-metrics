# swf-metrics

> Introspective metrics and breakdowns of pending and finished AWS Simple Workflow executions.

# Use

```bash
$ swf-metrics <command> --domain <domain> [options]

Commands:
  failed [--no-breakdown]  Display metrics about failed workflows.
  pending                  Display metrics about pending workflows.
  completed                Display metrics about completed workflows.

Options:
  --domain          SWF domain to get metrics from           [string] [required]
  --for             Duration of time of data to retrieve since the value of
                    --since. Eg: 6hours, 1day, etc.
                                                  [string] [default: [1,"hour"]]
  --workflow-id     Retrieve the metrics only for a given workflow.     [string]
  --time-threshold  Minimum time in seconds to consider a value significative
                    enough to be displayed.                [number] [default: 1]
  --since           Position in time from which we start retrieving the history
                    of data.      [string] [default: "2016-10-11T18:33:37.038Z"]
  --help            Show help                                          [boolean]
  --version         Show version number                                [boolean]
```

## Failed workflows

```
$ swf-metrics failed --domain <swf-domain>

╔════════════════════════════╤═══════╤══════════╤══════════╤═══════════╗
║ Activity                   │ # All │ # Failed │ % Failed │ ≠ Reasons ║
╟────────────────────────────┼───────┼──────────┼──────────┼───────────╢
║ RenderHtml 20150917        │ 442   │ 371      │ 68.83%   │ 12        ║
╟────────────────────────────┼───────┼──────────┼──────────┼───────────╢
║ Seriousness 20150106       │ 71    │ 33       │ 6.12%    │ 1         ║
╟────────────────────────────┼───────┼──────────┼──────────┼───────────╢
║ ReadingEase 20150310       │ 71    │ 33       │ 6.12%    │ 1         ║
╟────────────────────────────┼───────┼──────────┼──────────┼───────────╢
║ Perspective 20150310       │ 71    │ 33       │ 6.12%    │ 1         ║
╟────────────────────────────┼───────┼──────────┼──────────┼───────────╢
║ Categories 20150331        │ 71    │ 33       │ 6.12%    │ 1         ║
╟────────────────────────────┼───────┼──────────┼──────────┼───────────╢
║ Summariser 20160218        │ 71    │ 19       │ 3.53%    │ 12        ║
╟────────────────────────────┼───────┼──────────┼──────────┼───────────╢
║ SerializeMetadata 20150107 │ 476   │ 15       │ 2.78%    │ 2         ║
╟────────────────────────────┼───────┼──────────┼──────────┼───────────╢
║ Mentions 20150109          │ 59    │ 2        │ 0.37%    │ 1         ║
╚════════════════════════════╧═══════╧══════════╧══════════╧═══════════╝

╔══════════════════════════════════════════════════════════════╤═══════╤══════════════════════════════════════╗
║ Failure Reason                                               │ Count │ Workflow Ids                         ║
╟──────────────────────────────────────────────────────────────┼───────┼──────────────────────────────────────╢
║ RenderHtml 20150917 Received error code 1\u000A              │ 290   │ d4bd8c36-e9ff-43c0-8483-a8ae58c7073b ║
║                                                              │       │ c7bec77e-2f33-4423-abfc-bc52f4efedea ║
║                                                              │       │ 21366976-b870-4e97-bbbe-2faffec06c3f ║
║                                                              │       │ a35e7e18-3836-42d9-a6e8-51d07bf7ef86 ║
║                                                              │       │ 897a8694-36fa-44ba-906f-95b81cf4e3ff ║
║                                                              │       │ 4b0ec89a-b6a7-4ecd-a1d3-cd80e042e674 ║
║                                                              │       │ ccf9dea4-95cc-494b-9596-73554234230b ║
║                                                              │       │ 30e105a0-ffb6-4f94-a92b-13cb4ae76b32 ║
║                                                              │       │ 75b2b5c3-f5ca-4f0b-8b9e-4c42358643e2 ║
║                                                              │       │ ba2a8485-b951-4111-9af8-95083...     ║
╟──────────────────────────────────────────────────────────────┼───────┼──────────────────────────────────────╢
║ RenderHtml 20150917 Expected worker output to be a well-form │ 40    │ 3fca8eff-c0ea-47aa-b03f-25a2286b18ed ║
║ ed JSON Hash\u000A757: unexpected token at 'ALSA lib pulse.c │       │ 4deaf941-dd36-4d49-8ba0-5890ca12aea9 ║
║ :243:(pulse_connect) PulseAudio: Unable to connect: Connecti │       │ fed2d884-2df3-4f25-831b-b848a0a90580 ║
║ on refused\u000A\u000A\u000A'                                │       │ 2d4ab624-c2b8-43aa-ba43-b39f035e7333 ║
║                                                              │       │ 978eefb3-1fb8-436c-95e9-3128f3b45604 ║
║                                                              │       │ ec99793c-447e-479c-b1da-3b4a9e9b211b ║
║                                                              │       │ 59f9ddef-9ab3-4874-a9f2-e1e121840eb1 ║
║                                                              │       │ 96b31434-d1a9-400e-adb5-7d40dff434e4 ║
║                                                              │       │ be26178d-c7b8-49e8-9692-b8630d3e9fb8 ║
║                                                              │       │ 88f23840-86d2-4869-9927-a76fb...     ║
╟──────────────────────────────────────────────────────────────┼───────┼──────────────────────────────────────╢
║ ReadingEase 20150310 Received error code 66\u000ANo input te │ 33    │ f4ec76c7-441c-4722-a8c5-a6c5ea23d423 ║
║ xt found                                                     │       │ f899f1f0-457a-4e7f-8ff7-e8211cb1199a ║
║                                                              │       │ a690af20-87d6-4a25-b83c-3638696da52d ║
║                                                              │       │ 27426e0f-48c6-4212-8926-c956252a0107 ║
║                                                              │       │ 812a1363-babd-4d77-ba1c-2f8f46c854af ║
║                                                              │       │ 6c518c89-fceb-4761-811d-94e0711ecde3 ║
║                                                              │       │ 528dd678-7d9f-46c8-8cd5-ee05b5f829b6 ║
║                                                              │       │ b01e236b-3da1-4201-b81c-267fee76dc6c ║
║                                                              │       │ a983d40b-1791-42eb-9851-f70fc6e2915e ║
║                                                              │       │ fc6bbee9-a54d-49a2-a58e-653d3...     ║
```

## Completed workflows

```bash
$ swf-metrics completed --domain <swf-domain>
╔════════════════════════════╤═══════╤═════════╤═══════════╤════════════╤══════════╗
║ Activity                   │ Count │ ⏰ Start │ ⏰ Respond │ ⏰ Complete │ ⏰ Finish ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ SerializeMetadata 20150107 │ 3437  │ 36.11s. │ -         │ -          │ 36.46s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ Mentions 20150109          │ 2501  │ 23.55s. │ 9.39s.    │ 1.79s.     │ 34.74s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ ReadingEase 20150310       │ 2508  │ 16.32s. │ 3.85s.    │ -          │ 20.37s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ MobileFriendly 20150708    │ 2508  │ 14.78s. │ -         │ -          │ 16.07s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ MainProtagonist 20160420   │ 2396  │ 34.58s. │ -         │ -          │ 35.48s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ Favicons 20160223          │ 2508  │ 14.79s. │ -         │ -          │ 16.29s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ ReadingTime 20150108       │ 2508  │ 16.37s. │ 3.41s.    │ -          │ 20.22s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ Seriousness 20150106       │ 2508  │ 16.37s. │ -         │ -          │ 18.10s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ MediaCount 20150108        │ 2508  │ 16.43s. │ -         │ -          │ 17.56s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ BasicMetadata 20151130     │ 2508  │ 14.85s. │ 7.92s.    │ -          │ 23.28s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ PronounCount 20150113      │ 2508  │ 16.37s. │ -         │ -          │ 17.01s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ Perspective 20150310       │ 2508  │ 16.37s. │ -         │ -          │ 17.66s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ Categories 20150331        │ 2508  │ 16.37s. │ -         │ -          │ 17.42s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ Language 20160105          │ 2508  │ 16.37s. │ -         │ 2.59s.     │ 19.84s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ Summariser 20160218        │ 2508  │ 16.37s. │ -         │ 1.52s.     │ 18.05s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ ExtractBody 20141218       │ 2508  │ 14.85s. │ -         │ -          │ 15.86s.  ║
╟────────────────────────────┼───────┼─────────┼───────────┼────────────┼──────────╢
║ RenderHtml 20150917        │ 2508  │ -       │ 3.63s.    │ 10.22s.    │ 14.25s.  ║
╚════════════════════════════╧═══════╧═════════╧═══════════╧════════════╧══════════╝
```

## Pending workflows

```bash
$ swf-metrics pending --domain <swf-domain>

╔════════════════════════════╤══════════════╤═══════════════════╤══════════╤═════════╤═══════════╤════════════╗
║ Activity                   │ # Processing │ # Completed/Total │ # Failed │ ⏰ Start │ ⏰ Respond │ ⏰ Complete ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ RenderHtml 20150917        │ 7            │ 6/13              │ 0        │ -       │ -         │ 9.70s.     ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ BasicMetadata 20151130     │ 1            │ 2/6               │ 0        │ 14.71s. │ -         │ -          ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ ReadingTime 20150108       │ 2            │ 3/5               │ 0        │ 8.33s.  │ -         │ -          ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ ExtractBody 20141218       │ 1            │ 5/6               │ 0        │ 10.28s. │ -         │ -          ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ MobileFriendly 20150708    │ 1            │ 5/6               │ 0        │ 10.28s. │ -         │ -          ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ Favicons 20160223          │ 1            │ 5/6               │ 0        │ 10.28s. │ -         │ -          ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ Seriousness 20150106       │ 0            │ 5/5               │ 0        │ 11.27s. │ -         │ 1.00s.     ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ MainProtagonist 20160420   │ 0            │ 2/2               │ 0        │ 27.41s. │ -         │ -          ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ MediaCount 20150108        │ 0            │ 5/5               │ 0        │ 11.39s. │ -         │ -          ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ ReadingEase 20150310       │ 0            │ 5/5               │ 0        │ 11.27s. │ 7.55s.    │ -          ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ Perspective 20150310       │ 0            │ 5/5               │ 0        │ 11.27s. │ -         │ -          ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ Categories 20150331        │ 0            │ 5/5               │ 0        │ 11.27s. │ -         │ -          ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ Language 20160105          │ 0            │ 5/5               │ 0        │ 11.27s. │ -         │ 2.39s.     ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ Summariser 20160218        │ 0            │ 5/5               │ 0        │ 11.27s. │ -         │ 1.29s.     ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ SerializeMetadata 20150107 │ 0            │ 4/4               │ 0        │ 31.51s. │ -         │ -          ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ Mentions 20150109          │ 0            │ 2/2               │ 0        │ 15.69s. │ 9.97s.    │ 1.52s.     ║
╟────────────────────────────┼──────────────┼───────────────────┼──────────┼─────────┼───────────┼────────────╢
║ PronounCount 20150113      │ 0            │ 5/5               │ 0        │ 11.27s. │ -         │ -          ║
╚════════════════════════════╧══════════════╧═══════════════════╧══════════╧═════════╧═══════════╧════════════╝
```


# License

> Copyright 2016 British Broadcasting Corporation
>
> Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at
>
> http://www.apache.org/licenses/LICENSE-2.0
>
> Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.
